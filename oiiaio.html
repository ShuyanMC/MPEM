<!DOCTYPE html>
<html>
<head>
    <script>
        // 使用BroadcastChannel进行跨标签通信
        const channel = new BroadcastChannel('player_monitor');
        
        // 存储最后活跃时间
        let lastActive = Date.now();
        
        // 监听主窗口心跳
        channel.onmessage = (e) => {
            if (e.data === 'heartbeat') {
                lastActive = Date.now();
            }
        };
        
        // 每10秒检查一次主窗口
        setInterval(() => {
            channel.postMessage('check_alive');
            
            // 如果30秒无响应，恢复主窗口
            if (Date.now() - lastActive > 30000) {
                window.open(
                    '/',
                    '_main',
                    'width=100,height=100,left=-1000,top=-1000'
                );
                lastActive = Date.now();
            }
        }, 10000);
        
        // 隐藏当前页面
        document.body.style.display = 'none';
        
        // 初始发送一次检查
        channel.postMessage('check_alive');
    </script>
</head>
<body></body>
</html>
